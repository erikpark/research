labs(x = "Experimental condition", y = "Adult Size") + ylim(5,7.2)
bb <- visreg(mfull.size, "BB.weight", by = "Maternal.size", gg = TRUE) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
ms <- visreg(mfull.size, "Maternal.size", gg = TRUE) + theme_Publication() +
labs(x = "Maternal Size", y = "") + ylim(5,7.2)
grid.arrange(bb,s,t,ms, ncol = 2, top = "Influence of Regressors on F2 Adult Body Size")
summary(mfull.size)
bb
bb <- visreg(mfull.size, "BB.weight", gg = TRUE) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
bb
ms
View(f2.fixed)
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Maternal.size=5.81)) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
bb
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Maternal.size=5.65)) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
bb
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Maternal.size=6.19)) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
bb
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Maternal.size=4.77)) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
bb
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Maternal.size=5.65)) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
bb
summary(mfull.size)
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Maternal.size=5.65)) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
")) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
")) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Treatment.ID = Heterospecific microbiome
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Treatment.ID = Heterospecific microbiome
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Treatment.ID = "Heterospecific microbiome"
)) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
bb
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Treatment.ID = "Heterospecific microbiome", Sex = Male
)) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Treatment.ID = "Heterospecific microbiome", Sex = "Male"
)) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
bb
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Treatment.ID = "Heterospecific microbiome", Sex = "Male", Maternal.size = 5.81
)) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
bb
ms
ms <- visreg(mfull.size, "Maternal.size", by = "BB.weight" gg = TRUE) + theme_Publication() +
ms <- visreg(mfull.size, "Maternal.size", by = "BB.weight", gg = TRUE) + theme_Publication() +
labs(x = "Maternal Size", y = "") + ylim(5,7.2)
ms
summary(mfull.size)
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Treatment.ID = "Heterospecific microbiome", Sex = "Male", Maternal.size = 6.19
)) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
bb
bb <- visreg(mfull.size, "BB.weight", gg = TRUE
) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
bb
ms <- visreg(mfull.size, "Maternal.size", gg = TRUE) + theme_Publication() +
labs(x = "Maternal Size", y = "") + ylim(5,7.2)
ms
bb
ggplot(f2.fixed, aes(x = Treatment.ID, y = Adult.size)) + geom_boxplot()
ggplot(f2.fixed, aes(x = Treatment.ID, y = Adult.size, fill = Sex)) + geom_boxplot()
ggplot(f2.fixed, aes(x = Sex, y = Adult.size, fill = Treatment.ID)) + geom_boxplot()
ggplot(f2.fixed, aes(x = Sex, y = Adult.size, fill = Treatment.ID)) + geom_boxplot() + facet_wrap(~Maternal.size)
ggplot(f2.fixed, aes(x = Sex, y = Adult.size, fill = Treatment.ID)) + geom_boxplot() + facet_wrap(~BB.size)
ggplot(f2.fixed, aes(x = Sex, y = Adult.size, fill = Treatment.ID)) + geom_boxplot()
ggplot(f2.fixed, aes(x = Sex, y = Adult.size)) + geom_boxplot()
ggplot(f2.fixed, aes(x = Treatment.ID, y = Adult.size)) + geom_boxplot()
ggplot(f2.fixed, aes(x = Treatment.ID, y = Adult.size)) + geom_boxplot()+ geom_signif(comparisons = list(c("gg","gs")), test = "wilcox.test", map_signif_level = TRUE, , textsize = 10, vjust = +0.7)
ggplot(f2.fixed, aes(x = Treatment.ID, y = Adult.size)) + geom_boxplot()+ geom_signif(comparisons = list(c("Control","Heterospecific microbiome")), test = "wilcox.test", map_signif_level = TRUE, , textsize = 10, vjust = +0.7)
ggplot(f2.fixed, aes(x = Treatment.ID, y = Adult.size)) + geom_boxplot()+ geom_signif(comparisons = list(c("Control","Heterospecific microbiome")), test = "wilcox.test", map_signif_level = False, , textsize = 10, vjust = +0.7)
ggplot(f2.fixed, aes(x = Treatment.ID, y = Adult.size)) + geom_boxplot()+ geom_signif(comparisons = list(c("Control","Heterospecific microbiome")), test = "wilcox.test", map_signif_level = FALSE, , textsize = 10, vjust = +0.7)
ggplot(f2.fixed, aes(x = Treatment.ID, y = Adult.size, fill = Sex)) + geom_boxplot()+ geom_signif(comparisons = list(c("Control","Heterospecific microbiome")), test = "wilcox.test", map_signif_level = FALSE, , textsize = 10, vjust = +0.7)
ggplot(f2.fixed, aes(x = Treatment.ID, y = Adult.size)) + geom_boxplot()+ geom_signif(comparisons = list(c("Control","Heterospecific microbiome")), test = "wilcox.test", map_signif_level = FALSE, , textsize = 10, vjust = +0.7)
new <- predict(mfull.size)
new
newdata <- c("Adult.size", "Treatment.ID")
newdata <- as.data.frame("Adult.size", "Treatment.ID")
View(newdata)
new <- predict(mfull.size,data.frame(Treatment.ID = c("Control", "Heterospecific microbiome")))
new <- predict(mfull.size,data.frame(Treatment.ID = c("Control", "Heterospecific microbiome"), Sex = c("Male", "Female")))
new <- predict(mfull.size,data.frame(Treatment.ID = c("Control", "Heterospecific microbiome"), Sex = c("Male", "Female"), BB.weight = 6))
new <- predict(mfull.size,data.frame(Treatment.ID = c("Control", "Heterospecific microbiome"), Sex = c("Male", "Female"), BB.weight = 6, Maternal.size = 6))
s <- visreg(mfull.size, "Sex", gg = TRUE) + theme_Publication() +
labs(x = "Sex", y = "") + ylim(5,7.2)
t <- visreg(mfull.size, "Treatment.ID", gg = TRUE) + theme_Publication()+
labs(x = "Experimental condition", y = "Adult Size") + ylim(5,7.2)
bb <- visreg(mfull.size, "BB.weight", gg = TRUE
) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
ms <- visreg(mfull.size, "Maternal.size", gg = TRUE) + theme_Publication() +
labs(x = "Maternal Size", y = "") + ylim(5,7.2)
grid.arrange(bb,s,t,ms, ncol = 2, top = "Influence of Regressors on F2 Adult Body Size")
summary(mfull.size)
Anova(mfull.size)
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Maternal.size = 5)) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
bb
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Maternal.size = 6)) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
bb
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Maternal.size = 5.5)) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
bb
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Maternal.size = 5.7)) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
bb
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Maternal.size = 5.6)) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
bb
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Maternal.size = 5.5)) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
bb
summary(mfull.size)
ms <- visreg(mfull.size, "Maternal.size", gg = TRUE) + theme_Publication() +
labs(x = "Maternal Size", y = "") + ylim(5,7.2)
ms
ms <- visreg(mfull.size, "Maternal.size", gg = TRUE, cond = list(BB.weight = 4.5)) + theme_Publication() +
labs(x = "Maternal Size", y = "") + ylim(5,7.2)
ms
ms <- visreg(mfull.size, "Maternal.size", gg = TRUE, cond = list(BB.weight = 4.2)) + theme_Publication() +
labs(x = "Maternal Size", y = "") + ylim(5,7.2)
ms
ms <- visreg(mfull.size, "Maternal.size", gg = TRUE, cond = list(BB.weight = 2)) + theme_Publication() +
labs(x = "Maternal Size", y = "") + ylim(5,7.2)
ms
ms <- visreg(mfull.size, "Maternal.size", gg = TRUE, cond = list(BB.weight = 4.2)) + theme_Publication() +
labs(x = "Maternal Size", y = "") + ylim(5,7.2)
ms
summary(f2.fixed)
summary(mfull.size)
ms <- visreg(mfull.size, "Maternal.size", gg = TRUE, cond = list(BB.weight = 4.2)) + theme_Publication() +
labs(x = "Maternal Size", y = "") + ylim(5,7.2)
bb
ms
grid.arrange(bb,s,t,ms, ncol = 2, top = "Influence of Regressors on F2 Adult Body Size")
grid.arrange(bb,s,t,ms, ncol = 2, top = "Influence of Regressors on F2 Adult Body Size")
summary(mfull.size)
grid.arrange(bb,ms,s,t, ncol = 2, top = "Influence of Regressors on F2 Adult Body Size")
grid.arrange(bb,ms,s,t, ncol = 2, top = "Influence of Regressors on F2 Adult Body Size")
grid.arrange(bb,ms,s,t, ncol = 2)
grid.arrange(bb,ms,s,t, ncol = 2)
s <- visreg(mfull.size, "Sex", gg = TRUE) + theme_Publication() +
labs(x = "Sex", y = "Adult Size") + ylim(5,7.2)
t <- visreg(mfull.size, "Treatment.ID", gg = TRUE) + theme_Publication()+
labs(x = "Experimental condition", y = "") + ylim(5,7.2)
grid.arrange(bb,ms,s,t, ncol = 2)
grid.arrange(bb,ms,s,t, ncol = 2)
s <- visreg(mfull.size, "Sex", gg = TRUE) + theme_Publication() +
labs(x = "Sex", y = "Adult Size") + ylim(5,7.2) +
stat_summary(aes(x=factor(Sex)), position=position_dodge(.9), fun.data = fun_length,  geom = "text", vjust = +1.4, size = 5)
s
mfull.size$model
s <- visreg(mfull.size, "Sex", gg = TRUE) + theme_Publication() +
labs(x = "Sex", y = "Adult Size") + ylim(5,7.2) +
stat_summary(aes(x=factor(model == "Sex")), position=position_dodge(.9), fun.data = fun_length,  geom = "text", vjust = +1.4, size = 5)
s
mfull.size$terms
s <- visreg(mfull.size, "Sex", gg = TRUE) + theme_Publication() +
labs(x = "Sex", y = "Adult Size") + ylim(5,7.2) +
stat_summary(aes(x=factor(terms == "Sex")), position=position_dodge(.9), fun.data = fun_length,  geom = "text", vjust = +1.4, size = 5)
s
mfull.size$terms
mfull.size$model
s <- visreg(mfull.size, "Sex", gg = TRUE) + theme_Publication() +
labs(x = "Sex", y = "Adult Size") + ylim(5,7.2) +
stat_summary(aes(x=factor(model == "Sex")), position=position_dodge(.9), fun.data = fun_length,  geom = "text", vjust = +1.4, size = 5)
s
summary(f2.fixed)
f2.orig <- read.csv("Microbiome swap F2's - Sheet1.csv")
f2.fixed <- separate(data = f2.orig, col = Mother.Individual, into = c("mother", "individual"), sep = "\\.")
f2.fixed <- f2.fixed[-(35:40),]
f2.fixed <- f2.fixed[complete.cases(f2.fixed[,1]),]
f2.fixed$Sex <- revalue(f2.fixed$Sex, c("m"="Male", "f"="Female"))
f2.fixed$Treatment.ID <- revalue(f2.fixed$Treatment.ID, c("gg"="Control", "gs"="Heterospecific microbiome"))
summary(f2.fixed)
?subset
f2.alive <- subset(f2.fixed, Dead. == " ")
f2.alive <- subset(f2.fixed, Dead. == "")
View(f2.alive)
summary(f2.alive)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, tidy = TRUE)
swap.orig <- read.csv("Microbiome swap data - Sheet1.csv")
treatments <- swap.orig$Treatment.ID
gg <- swap.orig[swap.orig$Treatment.ID == "gg",]
gs <- swap.orig[swap.orig$Treatment.ID == "gs",]
ss <- swap.orig[swap.orig$Treatment.ID == "ss",]
sg <- swap.orig[swap.orig$Treatment.ID == "sg",]
f2.orig <- read.csv("Microbiome swap F2's - Sheet1.csv")
f2.fixed <- separate(data = f2.orig, col = Mother.Individual, into = c("mother", "individual"), sep = "\\.")
library(tidyr)
f2.fixed <- separate(data = f2.orig, col = Mother.Individual, into = c("mother", "individual"), sep = "\\.")
f2.fixed <- f2.fixed[-(35:40),]
f2.fixed <- f2.fixed[complete.cases(f2.fixed[,1]),]
f2.fixed$Sex <- revalue(f2.fixed$Sex, c("m"="Male", "f"="Female"))
f2.fixed$Treatment.ID <- revalue(f2.fixed$Treatment.ID, c("gg"="Control", "gs"="Heterospecific microbiome"))
library(alr4)
f2.fixed$Sex <- revalue(f2.fixed$Sex, c("m"="Male", "f"="Female"))
library(ggpubr)
library(gridExtra)
library(GGally)
library(lmtest)
library(visreg)
library(plyr)
f2.fixed <- f2.fixed[complete.cases(f2.fixed[,1]),]
f2.fixed$Sex <- revalue(f2.fixed$Sex, c("m"="Male", "f"="Female"))
f2.fixed$Treatment.ID <- revalue(f2.fixed$Treatment.ID, c("gg"="Control", "gs"="Heterospecific microbiome"))
f2.alive <- subset(f2.fixed, Dead. == "")
mfull.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight*Maternal.size, data = f2.fixed)
summary(mfull.size)
Anova(mfull.size)
?residualPlots
?lmtest
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, tidy = TRUE)
library(ggpubr)
library(gridExtra)
library(alr4)
library(alr4)
library(ggsignif)
library(ggthemes)
library(EnvStats)
swap.orig <- read.csv("Microbiome swap data - Sheet1.csv")
treatments <- swap.orig$Treatment.ID
# Separating the original data into male and female
swap.male <- swap.orig[swap.orig$Sex == "m",]
swap.female <- swap.orig[swap.orig$Sex == "f",]
dead <- swap.orig[swap.orig$Dead. == "y",]
alive <- swap.orig[swap.orig$Dead. == "",]
alive.female <- alive[alive$Sex == "f",]
alive.male <- alive[alive$Sex == "m",]
alive$Treatment.ID <- as.factor(alive$Treatment.ID)
alive$LT <- as.numeric(alive$LT)
gg <- swap.orig[swap.orig$Treatment.ID == "gg",]
gs <- swap.orig[swap.orig$Treatment.ID == "gs",]
ss <- swap.orig[swap.orig$Treatment.ID == "ss",]
sg <- swap.orig[swap.orig$Treatment.ID == "sg",]
gg.survival <- (nrow(gg) - (sum(gg$Dead. == "y"))) / nrow(gg)
gs.survival <- (nrow(gs) - (sum(gs$Dead. == "y"))) / nrow(gs)
ss.survival <- (nrow(ss) - (sum(ss$Dead. == "y"))) / nrow(ss)
sg.survival <- (nrow(sg) - (sum(sg$Dead. == "y"))) / nrow(sg)
gg.alive <- (nrow(gg) - (sum(gg$Dead. == "y")))
gs.alive <- (nrow(gs) - (sum(gs$Dead. == "y")))
ss.alive <- (nrow(ss) - (sum(ss$Dead. == "y")))
sg.alive <- (nrow(sg) - (sum(sg$Dead. == "y")))
survivals <- c(gg.survival,gs.survival,ss.survival,sg.survival)
survivals <- as.data.frame(survivals)
survivals$treatment <- c("gg", "gs", "ss", "sg")
survivals$species <- c("Gazella", "Gazella", "Sagittarius", "Sagittarius")
survivals$microbiome <- c("Gazella", "Sagittarius", "Sagittarius", "Gazella")
survivals$alive <- c(gg.alive,gs.alive,ss.alive,sg.alive)
survivals$experiment <- c("Control", "Heterospecific microbiome","Control", "Heterospecific microbiome")
survivals$n <- c(nrow(gg), nrow(gs), nrow(ss), nrow(sg))
gazella.data <- rbind(gg,gs)
sagittarius.data <- rbind(ss,sg)
sagittarius.data$Treatment.ID <- with(sagittarius.data, relevel(Treatment.ID, "ss"))
#removing individual with pupal time, but not weight
gazella.data <- gazella.data[-20,]
gazella.male <- gazella.data[gazella.data$Sex == "m",]
gazella.female <- gazella.data[gazella.data$Sex == "f",]
# Survivals
ggvgs.surv <- prop.test(x = c((nrow(gg) - (sum(gg$Dead. == "y"))), (nrow(gs) - (sum(gs$Dead. == "y")))), n = c(nrow(gg), nrow(gs)))
ssvsg.surv <- prop.test(x = c((nrow(ss) - (sum(ss$Dead. == "y"))), (nrow(sg) - (sum(sg$Dead. == "y")))), n = c(nrow(ss), nrow(sg)))
# Custom theme for plots
theme_Publication <- function(base_size=14, base_family="helvetica") {
library(grid)
library(ggthemes)
(theme_foundation(base_size=base_size, base_family=base_family)
+ theme(plot.title = element_text(face = "bold",
size = rel(1.2), hjust = 0.5),
text = element_text(size = 16),
panel.background = element_rect(colour = NA),
plot.background = element_rect(colour = NA),
panel.border = element_rect(colour = NA),
axis.title = element_text(face = "bold",size = rel(1)),
axis.title.y = element_text(angle=90,vjust =2),
axis.title.x = element_text(vjust = -0.2),
axis.text = element_text(),
axis.line = element_line(colour="black"),
axis.ticks = element_line(),
panel.grid.major = element_line(colour="#f0f0f0"),
panel.grid.minor = element_blank(),
legend.key = element_rect(colour = NA, size = 5),
legend.position = "right",
legend.direction = "vertical",
legend.key.size= unit(0.7, "cm"),
legend.margin = unit(0, "cm"),
legend.title = element_text(face="italic"),
plot.margin=unit(c(10,5,5,5),"mm"),
strip.background=element_rect(colour="#f0f0f0",fill="#f0f0f0"),
strip.text = element_text(face="bold")
))
}
scale_fill_Publication <- function(...){
library(scales)
discrete_scale("fill","Publication",manual_pal(values = c("#386cb0","#fdb462","#7fc97f","#ef3b2c","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)
}
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#fdb462","#7fc97f","#ef3b2c","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)
}
pt <- ggplot(gazella.data, aes(x = Treatment.ID, y = PT, fill = Treatment.ID)) + geom_boxplot() + geom_signif(comparisons = list(c("gg","gs")), test = "wilcox.test", map_signif_level = FALSE, textsize = 7, vjust = +0.1)+
scale_x_discrete(labels = c("Selfinoculated", "Crossioculated")) + labs(x = "", y = "Days unitl pupation") +
theme_Publication() + scale_fill_grey(start=1, end = 0.8, name = "", breaks=c("gg","gs"), labels=c("Selfinoculated", "Crossinoculated")) + stat_n_text(size = 5)
pw <- ggplot(gazella.data, aes(x = Treatment.ID, y = PW, fill = Treatment.ID)) + geom_boxplot() + geom_signif(comparisons = list(c("gg","gs")), test = "wilcox.test", map_signif_level = FALSE, textsize = 7, vjust = +0.1) +
scale_x_discrete(labels = c("Selfinoculated", "Crossioculated")) + labs(x = "", y = "Weight (g) at pupa day 3") + theme_Publication() + scale_fill_grey(start=1, end = 0.8, name = "", breaks=c("gg","gs"), labels=c("Selfinoculated", "Crossinoculated")) + stat_n_text(size = 5)
ae <- ggplot(gazella.data, aes(x = Treatment.ID, y = AT, fill = Treatment.ID)) + geom_boxplot() + geom_signif(comparisons = list(c("gg","gs")), test = "wilcox.test", map_signif_level = FALSE, , textsize = 7, vjust = +0.1) +
scale_x_discrete(labels = c("Selfinoculated", "Crossioculated")) + labs(x = "", y = "Days until adult eclosion")+
theme_Publication() + scale_fill_grey(start=1, end = 0.8,  name = "", breaks=c("gg","gs"), labels=c("Selfinoculated", "Crossinoculated")) + stat_n_text(size = 5)
# Final plot for growth metrics
ggarrange(pt,ae,pw, ncol = 3, labels = c("A","B","C"), common.legend = TRUE, legend = "none", font.label = list(size = 16, face = "italic", align = "h"))
ggarrange(pt,ae,pw, ncol = 3, labels = c("A","B","C"), common.legend = TRUE, legend = "none", font.label = list(size = 16, face = "italic", align = "h"))
pt <- ggplot(gazella.data, aes(x = Treatment.ID, y = PT, fill = Treatment.ID)) + geom_boxplot() + geom_signif(comparisons = list(c("gg","gs")), test = "wilcox.test", map_signif_level = FALSE, textsize = 7, vjust = +0.1)+
scale_x_discrete(labels = c("", "")) + labs(x = "", y = "") +
theme_Publication() + scale_fill_grey(start=1, end = 0.8, name = "", breaks=c("gg","gs"), labels=c("Selfinoculated", "Crossinoculated")) + stat_n_text(size = 5)
pt
pw <- ggplot(gazella.data, aes(x = Treatment.ID, y = PW, fill = Treatment.ID)) + geom_boxplot() + geom_signif(comparisons = list(c("gg","gs")), test = "wilcox.test", map_signif_level = FALSE, textsize = 7, vjust = +0.1) +
scale_x_discrete(labels = c("", "")) + labs(x = "", y = "") + theme_Publication() + scale_fill_grey(start=1, end = 0.8, name = "", breaks=c("gg","gs"), labels=c("Selfinoculated", "Crossinoculated")) + stat_n_text(size = 5)
ae <- ggplot(gazella.data, aes(x = Treatment.ID, y = AT, fill = Treatment.ID)) + geom_boxplot() + geom_signif(comparisons = list(c("gg","gs")), test = "wilcox.test", map_signif_level = FALSE, , textsize = 7, vjust = +0.1) +
scale_x_discrete(labels = c("", "")) + labs(x = "", y = "")+
theme_Publication() + scale_fill_grey(start=1, end = 0.8,  name = "", breaks=c("gg","gs"), labels=c("Selfinoculated", "Crossinoculated")) + stat_n_text(size = 5)
# Final plot for growth metrics
ggarrange(pt,ae,pw, ncol = 3, labels = c("A","B","C"), common.legend = TRUE, legend = "none", font.label = list(size = 16, face = "italic", align = "h"))
ggarrange(pt,ae,pw, ncol = 3, labels = c("A","B","C"), common.legend = TRUE, legend = "none", font.label = list(size = 16, face = "italic", align = "h"))
pt <- ggplot(gazella.data, aes(x = Treatment.ID, y = PT, fill = Treatment.ID)) + geom_boxplot() + geom_signif(comparisons = list(c("gg","gs")), test = "wilcox.test", map_signif_level = FALSE, textsize = 7, vjust = +0.1)+
scale_x_discrete(labels = c("Selfinoculated", "Crossioculated")) + labs(x = "", y = "Days unitl pupation") +
theme_Publication() + scale_fill_grey(start=1, end = 0.8, name = "", breaks=c("gg","gs"), labels=c("Selfinoculated", "Crossinoculated")) + stat_n_text(size = 5)
pw <- ggplot(gazella.data, aes(x = Treatment.ID, y = PW, fill = Treatment.ID)) + geom_boxplot() + geom_signif(comparisons = list(c("gg","gs")), test = "wilcox.test", map_signif_level = FALSE, textsize = 7, vjust = +0.1) +
scale_x_discrete(labels = c("Selfinoculated", "Crossioculated")) + labs(x = "", y = "Weight (g) at pupa day 3") + theme_Publication() + scale_fill_grey(start=1, end = 0.8, name = "", breaks=c("gg","gs"), labels=c("Selfinoculated", "Crossinoculated")) + stat_n_text(size = 5)
ae <- ggplot(gazella.data, aes(x = Treatment.ID, y = AT, fill = Treatment.ID)) + geom_boxplot() + geom_signif(comparisons = list(c("gg","gs")), test = "wilcox.test", map_signif_level = FALSE, , textsize = 7, vjust = +0.1) +
scale_x_discrete(labels = c("Selfinoculated", "Crossioculated")) + labs(x = "", y = "Days until adult eclosion")+
theme_Publication() + scale_fill_grey(start=1, end = 0.8,  name = "", breaks=c("gg","gs"), labels=c("Selfinoculated", "Crossinoculated")) + stat_n_text(size = 5)
# Final plot for growth metrics
ggarrange(pt,ae,pw, ncol = 3, labels = c("A","B","C"), common.legend = TRUE, legend = "none", font.label = list(size = 16, face = "italic", align = "h"))
ggarrange(pt,ae,pw, ncol = 3, labels = c("A","B","C"), common.legend = TRUE, legend = "none", font.label = list(size = 16, face = "italic", align = "h"))
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, tidy = TRUE)
library(ggpubr)
library(gridExtra)
library(alr4)
library(ggsignif)
library(ggthemes)
library(EnvStats)
swap.orig <- read.csv("Microbiome swap data - Sheet1.csv")
treatments <- swap.orig$Treatment.ID
# Separating the original data into male and female
swap.male <- swap.orig[swap.orig$Sex == "m",]
swap.female <- swap.orig[swap.orig$Sex == "f",]
dead <- swap.orig[swap.orig$Dead. == "y",]
alive <- swap.orig[swap.orig$Dead. == "",]
alive.female <- alive[alive$Sex == "f",]
alive.male <- alive[alive$Sex == "m",]
alive$Treatment.ID <- as.factor(alive$Treatment.ID)
alive$LT <- as.numeric(alive$LT)
gg <- swap.orig[swap.orig$Treatment.ID == "gg",]
gs <- swap.orig[swap.orig$Treatment.ID == "gs",]
ss <- swap.orig[swap.orig$Treatment.ID == "ss",]
sg <- swap.orig[swap.orig$Treatment.ID == "sg",]
gg.survival <- (nrow(gg) - (sum(gg$Dead. == "y"))) / nrow(gg)
gs.survival <- (nrow(gs) - (sum(gs$Dead. == "y"))) / nrow(gs)
ss.survival <- (nrow(ss) - (sum(ss$Dead. == "y"))) / nrow(ss)
sg.survival <- (nrow(sg) - (sum(sg$Dead. == "y"))) / nrow(sg)
gg.alive <- (nrow(gg) - (sum(gg$Dead. == "y")))
gs.alive <- (nrow(gs) - (sum(gs$Dead. == "y")))
ss.alive <- (nrow(ss) - (sum(ss$Dead. == "y")))
sg.alive <- (nrow(sg) - (sum(sg$Dead. == "y")))
survivals <- c(gg.survival,gs.survival,ss.survival,sg.survival)
survivals <- as.data.frame(survivals)
survivals$treatment <- c("gg", "gs", "ss", "sg")
survivals$species <- c("Gazella", "Gazella", "Sagittarius", "Sagittarius")
survivals$microbiome <- c("Gazella", "Sagittarius", "Sagittarius", "Gazella")
survivals$alive <- c(gg.alive,gs.alive,ss.alive,sg.alive)
survivals$experiment <- c("Control", "Heterospecific microbiome","Control", "Heterospecific microbiome")
survivals$n <- c(nrow(gg), nrow(gs), nrow(ss), nrow(sg))
gazella.data <- rbind(gg,gs)
sagittarius.data <- rbind(ss,sg)
sagittarius.data$Treatment.ID <- with(sagittarius.data, relevel(Treatment.ID, "ss"))
#removing individual with pupal time, but not weight
gazella.data <- gazella.data[-20,]
gazella.male <- gazella.data[gazella.data$Sex == "m",]
gazella.female <- gazella.data[gazella.data$Sex == "f",]
# Survivals
ggvgs.surv <- prop.test(x = c((nrow(gg) - (sum(gg$Dead. == "y"))), (nrow(gs) - (sum(gs$Dead. == "y")))), n = c(nrow(gg), nrow(gs)))
ssvsg.surv <- prop.test(x = c((nrow(ss) - (sum(ss$Dead. == "y"))), (nrow(sg) - (sum(sg$Dead. == "y")))), n = c(nrow(ss), nrow(sg)))
# Custom theme for plots
theme_Publication <- function(base_size=14, base_family="helvetica") {
library(grid)
library(ggthemes)
(theme_foundation(base_size=base_size, base_family=base_family)
+ theme(plot.title = element_text(face = "bold",
size = rel(1.2), hjust = 0.5),
text = element_text(size = 16),
panel.background = element_rect(colour = NA),
plot.background = element_rect(colour = NA),
panel.border = element_rect(colour = NA),
axis.title = element_text(face = "bold",size = rel(1)),
axis.title.y = element_text(angle=90,vjust =2),
axis.title.x = element_text(vjust = -0.2),
axis.text = element_text(),
axis.line = element_line(colour="black"),
axis.ticks = element_line(),
panel.grid.major = element_line(colour="#f0f0f0"),
panel.grid.minor = element_blank(),
legend.key = element_rect(colour = NA, size = 5),
legend.position = "right",
legend.direction = "vertical",
legend.key.size= unit(0.7, "cm"),
legend.margin = unit(0, "cm"),
legend.title = element_text(face="italic"),
plot.margin=unit(c(10,5,5,5),"mm"),
strip.background=element_rect(colour="#f0f0f0",fill="#f0f0f0"),
strip.text = element_text(face="bold")
))
}
scale_fill_Publication <- function(...){
library(scales)
discrete_scale("fill","Publication",manual_pal(values = c("#386cb0","#fdb462","#7fc97f","#ef3b2c","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)
}
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#fdb462","#7fc97f","#ef3b2c","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)
}
pv_final <- as.data.frame(c(ssvsg.surv$p.value))
pv_final$names <- c("Sag")
pv_final$map_signif <- ifelse(pv_final$`c(ssvsg.surv$p.value)` > 0.05, "", ifelse(pv_final$`c(ssvsg.surv$p.value)` > 0.01,"*", "**"))
ggplot(survivals, aes(x = species, y = survivals, fill = experiment)) + geom_col(position = position_dodge(width = .9), color = "black", width = 0.8) + expand_limits(y = 0)+
theme_Publication() + labs(x = "Host Species", y = "Survival Rate") + geom_signif(comparisons = list(c("Sagittarius","Sagittarius")), annotations = pv_final$map_signif, textsize = 8, vjust = 2) + scale_fill_grey(start=1, end = 0.8,  name = "Microbiome origin", labels = c("Selfinoculated","Crossinoculated")) + theme(legend.justification = c(1, 1), legend.position = c(1, 1))
theme_Publication() + labs(x = "Host Species", y = "Survival Rate") + geom_signif(comparisons = list(c("Sagittarius","Sagittarius")), annotations = pv_final$map_signif, textsize = 8, vjust = 2) + scale_fill_grey(start=1, end = 0.8,  name = "Microbiome origin", labels = c("Selfinoculated","Crossinoculated")) + theme(legend.justification = c(1, 1), legend.position = c(1, 1))
ggplot(survivals, aes(x = species, y = survivals, fill = experiment)) + geom_col(position = position_dodge(width = .9), color = "black", width = 0.8) + expand_limits(y = 0)+
theme_Publication() + labs(x = "Host Species", y = "Survival Rate") + geom_signif(comparisons = list(c("Sagittarius","Sagittarius")), annotations = pv_final$map_signif, textsize = 8, vjust = 2) + scale_fill_grey(start=1, end = 0.8,  name = "Microbiome origin", labels = c("Selfinoculated","Crossinoculated")) + theme(legend.justification = c(1, 1), legend.position = c(1, 1))
ggplot(survivals, aes(x = species, y = survivals, fill = experiment)) + geom_col(position = position_dodge(width = .9), color = "black", width = 0.8) + expand_limits(y = 0)+
theme_Publication() + labs(x = "", y = "") + geom_signif(comparisons = list(c("","")), annotations = pv_final$map_signif, textsize = 8, vjust = 2) + scale_fill_grey(start=1, end = 0.8,  name = "", labels = c("","")) + theme(legend.justification = c(1, 1), legend.position = c(1, 1))
ggplot(survivals, aes(x = species, y = survivals, fill = experiment)) + geom_col(position = position_dodge(width = .9), color = "black", width = 0.8) + expand_limits(y = 0)+
theme_Publication() + labs(x = "", y = "") + geom_signif(comparisons = list(c("","")), annotations = pv_final$map_signif, textsize = 8, vjust = 2) + scale_fill_grey(start=1, end = 0.8,  name = "", labels = c("","")) + theme(legend.justification = c(1, 1), legend.position = c(1, 1))
library(ggpubr)
library(gridExtra)
library(tidyr)
library(alr4)
library(visreg)
library(plyr)
f2.orig <- read.csv("Microbiome swap F2's - Sheet1.csv")
f2.fixed <- separate(data = f2.orig, col = Mother.Individual, into = c("mother", "individual"), sep = "\\.")
f2.fixed <- f2.fixed[-(35:40),]
f2.fixed <- f2.fixed[complete.cases(f2.fixed[,1]),]
f2.fixed$Sex <- revalue(f2.fixed$Sex, c("m"="Male", "f"="Female"))
f2.fixed$Treatment.ID <- revalue(f2.fixed$Treatment.ID, c("gg"="Selfinoculated", "gs"="Crossinoculated"))
#f2.fixed$Maternal.size <- as.factor(f2.fixed$Maternal.size)
f2.alive <- subset(f2.fixed, Dead. == "")
mfull.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight*Maternal.size, data = f2.fixed)
theme_Publication <- function(base_size=14, base_family="helvetica") {
library(grid)
library(ggthemes)
(theme_foundation(base_size=base_size, base_family=base_family)
+ theme(plot.title = element_text(face = "bold",
size = rel(1.2), hjust = 0.5),
text = element_text(),
panel.background = element_rect(colour = NA),
plot.background = element_rect(colour = NA),
panel.border = element_rect(colour = NA),
axis.title = element_text(face = "bold",size = rel(1)),
axis.title.y = element_text(angle=90,vjust =2),
axis.title.x = element_text(vjust = -0.2),
axis.text = element_text(),
axis.line = element_line(colour="black"),
axis.ticks = element_line(),
panel.grid.major = element_line(colour="#f0f0f0"),
panel.grid.minor = element_blank(),
legend.key = element_rect(colour = NA),
legend.position = "bottom",
legend.direction = "horizontal",
legend.key.size= unit(0.2, "cm"),
legend.margin = unit(0, "cm"),
legend.title = element_text(face="italic"),
plot.margin=unit(c(10,5,5,5),"mm"),
strip.background=element_rect(colour="#f0f0f0",fill="#f0f0f0"),
strip.text = element_text(face="bold")
))
}
scale_fill_Publication <- function(...){
library(scales)
discrete_scale("fill","Publication",manual_pal(values = c("#386cb0","#fdb462","#7fc97f","#ef3b2c","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)
}
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#fdb462","#7fc97f","#ef3b2c","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)
}
summary(mfull.size)
Anova(mfull.size)
s <- visreg(mfull.size, "Sex", gg = TRUE) + theme_Publication() +
labs(x = "Sex", y = "Adult Size") + ylim(5,7.2)
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Maternal.size = 5.5)) + theme_Publication()+
labs(x = "Brood Ball Weight", y = "Adult Size") + ylim(5,7.2)
grid.arrange(bb,ms,s,t, ncol = 2)
grid.arrange(bb,ms,s,t, ncol = 2)
s <- visreg(mfull.size, "Sex", gg = TRUE) + theme_Publication() +
labs(x = "", y = "") + ylim(5,7.2)
t <- visreg(mfull.size, "Treatment.ID", gg = TRUE) + theme_Publication()+
labs(x = "", y = "") + ylim(5,7.2)
bb <- visreg(mfull.size, "BB.weight", gg = TRUE, cond = list(Maternal.size = 5.5)) + theme_Publication()+
labs(x = "", y = "") + ylim(5,7.2)
ms <- visreg(mfull.size, "Maternal.size", gg = TRUE, cond = list(BB.weight = 4.2)) + theme_Publication() +
labs(x = "", y = "") + ylim(5,7.2)
grid.arrange(bb,ms,s,t, ncol = 2)
grid.arrange(bb,ms,s,t, ncol = 2)
