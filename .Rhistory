stat_summary(aes(x=factor(Treatment.ID)), position=position_dodge(.9), fun.data = fun_length,  geom = "text",
vjust = +1.5, size = 4) + labs(title = "Time to pupation for all individuals")
h <- ggplot(swap.orig, aes(x = Treatment.ID, y = PW)) + geom_boxplot() + stat_compare_means(method = "wilcox.test", comparisons = list(c("gg","gs"), c("sg","ss"))) +
stat_summary(aes(x=factor(Treatment.ID)), position=position_dodge(.9), fun.data = fun_length,  geom = "text",
vjust = +1.1, size = 4) + labs(title = "Weight at P day 3 for all individuals")
grid.arrange(a,b)
grid.arrange(c,d)
grid.arrange(a,b)
a
grid.arrange(a,b, ncol = 2)
a
b
grid.arrange(a,b, ncol = 2)
grid.arrange(c,d, ncol = 2)
grid.arrange(e,f, ncol = 2)
grid.arrange(g,h, ncol = 2)
ggplot(alive, aes(x = Treatment.ID, y = AT)) + geom_boxplot() + stat_compare_means(method = "wilcox.test", comparisons = list(c("gg","gs"), c("sg","ss"))) +
stat_summary(aes(x=factor(Treatment.ID)), position=position_dodge(.9), fun.data = fun_length,  geom = "text",
vjust = +1.5, size = 4) + labs(title = "Time to adult eclosion")
ggplot(alive, aes(x = Treatment.ID, y = ATW)) + geom_boxplot() + stat_compare_means(method = "wilcox.test", comparisons = list(c("gg","gs"), c("sg","ss"))) +
stat_summary(aes(x=factor(Treatment.ID)), position=position_dodge(.9), fun.data = fun_length,  geom = "text",
vjust = +1.5, size = 4) + labs(title = "Adult thorax width")
ggvgs.surv <- prop.test(x = c((nrow(gg) - (sum(gg$Dead. == "y"))), (nrow(gs) - (sum(gs$Dead. == "y")))), n = c(nrow(gg), nrow(gs)))
ggvgs.surv
ssvsg.surv <- prop.test(x = c((nrow(ss) - (sum(ss$Dead. == "y"))), (nrow(sg) - (sum(sg$Dead. == "y")))), n = c(nrow(ss), nrow(sg)))
ssvsg.surv
ggplot(survivals, aes(x = treatment, y = survivals)) + geom_point()
ggvgs.surv
ssvsg.surv
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(ggpubr)
library(gridExtra)
swap.orig <- read.csv("Microbiome swap data - Sheet1.csv")
treatments <- swap.orig$Treatment.ID
dead <- swap.orig[swap.orig$Dead. == "y",]
alive$Treatment.ID <- as.factor(alive$Treatment.ID)
gg <- swap.orig[swap.orig$Treatment.ID == "gg",]
ss <- swap.orig[swap.orig$Treatment.ID == "ss",]
gg.survival <- (nrow(gg) - (sum(gg$Dead. == "y"))) / nrow(gg)
gs.survival <- (nrow(gs) - (sum(gs$Dead. == "y"))) / nrow(gs)
ss.survival <- (nrow(ss) - (sum(ss$Dead. == "y"))) / nrow(ss)
sg.survival <- (nrow(sg) - (sum(sg$Dead. == "y"))) / nrow(sg)
survivals <- c(gg.survival,gs.survival,ss.survival,sg.survival)
survivals <- as.data.frame(survivals)
survivals$treatment <- c("gg", "gs", "ss", "sg")
fun_length <- function(x){
return(data.frame(y=median(x),label= paste0("n=", length(x))))
}
swap.orig
View(swap.orig)
alive.female <- alive[alive$Sex == "f"]
alive[alive$Sex]
alive[alive$Sex == "f"]
alive[alive$Sex == "F"]
alive$Sex == "f"
alive.female <- alive[alive$Sex == "f",]
alive.male <- alive[alive$Sex == "m",]
View(alive.male)
View(alive.female)
me <- ggplot(alive.male, aes(x = Treatment.ID, y = AT)) + geom_boxplot() + stat_compare_means(method = "wilcox.test", comparisons = list(c("gg","gs"), c("sg","ss"))) +
stat_summary(aes(x=factor(Treatment.ID)), position=position_dodge(.9), fun.data = fun_length,  geom = "text",
vjust = +1.5, size = 4) + labs(title = "Time to adult eclosion - males only")
fe <- ggplot(alive.female, aes(x = Treatment.ID, y = AT)) + geom_boxplot() + stat_compare_means(method = "wilcox.test", comparisons = list(c("gg","gs"), c("sg","ss"))) +
stat_summary(aes(x=factor(Treatment.ID)), position=position_dodge(.9), fun.data = fun_length,  geom = "text",
vjust = +1.5, size = 4) + labs(title = "Time to adult eclosion - females only")
grid.arrange(me,fe, ncol = 2)
ggplot(alive, aes(x = Treatment.ID, y = AT)) + geom_boxplot() + stat_compare_means(method = "wilcox.test", comparisons = list(c("gg","gs"), c("sg","ss"))) +
stat_summary(aes(x=factor(Treatment.ID)), position=position_dodge(.9), fun.data = fun_length,  geom = "text",
vjust = +1.5, size = 4) + labs(title = "Time to adult eclosion")
grid.arrange(me,fe, ncol = 2)
ggplot(alive, aes(x = Treatment.ID, y = ATW)) + geom_boxplot() + stat_compare_means(method = "wilcox.test", comparisons = list(c("gg","gs"), c("sg","ss"))) +
stat_summary(aes(x=factor(Treatment.ID)), position=position_dodge(.9), fun.data = fun_length,  geom = "text",
vjust = +1.5, size = 4) + labs(title = "Adult thorax width")
mw <- ggplot(alive, aes(x = Treatment.ID, y = ATW)) + geom_boxplot() + stat_compare_means(method = "wilcox.test", comparisons = list(c("gg","gs"), c("sg","ss"))) +
stat_summary(aes(x=factor(Treatment.ID)), position=position_dodge(.9), fun.data = fun_length,  geom = "text",
vjust = +1.5, size = 4) + labs(title = "Adult thorax width")
fw <- ggplot(alive, aes(x = Treatment.ID, y = ATW)) + geom_boxplot() + stat_compare_means(method = "wilcox.test", comparisons = list(c("gg","gs"), c("sg","ss"))) +
stat_summary(aes(x=factor(Treatment.ID)), position=position_dodge(.9), fun.data = fun_length,  geom = "text",
vjust = +1.5, size = 4) + labs(title = "Adult thorax width")
mw <- ggplot(alive.male, aes(x = Treatment.ID, y = ATW)) + geom_boxplot() + stat_compare_means(method = "wilcox.test", comparisons = list(c("gg","gs"), c("sg","ss"))) +
stat_summary(aes(x=factor(Treatment.ID)), position=position_dodge(.9), fun.data = fun_length,  geom = "text",
vjust = +1.5, size = 4) + labs(title = "Adult thorax width - males only")
fw <- ggplot(alive/female, aes(x = Treatment.ID, y = ATW)) + geom_boxplot() + stat_compare_means(method = "wilcox.test", comparisons = list(c("gg","gs"), c("sg","ss"))) +
stat_summary(aes(x=factor(Treatment.ID)), position=position_dodge(.9), fun.data = fun_length,  geom = "text",
vjust = +1.5, size = 4) + labs(title = "Adult thorax width - females only")
fw <- ggplot(alive.female, aes(x = Treatment.ID, y = ATW)) + geom_boxplot() + stat_compare_means(method = "wilcox.test", comparisons = list(c("gg","gs"), c("sg","ss"))) +
stat_summary(aes(x=factor(Treatment.ID)), position=position_dodge(.9), fun.data = fun_length,  geom = "text",
vjust = +1.5, size = 4) + labs(title = "Adult thorax width - females only")
grid.arrange(mw,fw, ncol = 2)
grid.arrange(me,fe, ncol = 2)
ggplot(alive, aes(x = Treatment.ID, y = ATW)) + geom_boxplot() + stat_compare_means(method = "wilcox.test", comparisons = list(c("gg","gs"), c("sg","ss"))) +
stat_summary(aes(x=factor(Treatment.ID)), position=position_dodge(.9), fun.data = fun_length,  geom = "text",
vjust = +1.5, size = 4) + labs(title = "Adult thorax width")
grid.arrange(mw,fw, ncol = 2)
mfw <- grid.arrange(mw,fw, ncol = 2)
tw <- ggplot(alive, aes(x = Treatment.ID, y = ATW)) + geom_boxplot() + stat_compare_means(method = "wilcox.test", comparisons = list(c("gg","gs"), c("sg","ss"))) +
stat_summary(aes(x=factor(Treatment.ID)), position=position_dodge(.9), fun.data = fun_length,  geom = "text",
vjust = +1.5, size = 4) + labs(title = "Adult thorax width")
grid.arrange(tw, mfw)
mfe <- grid.arrange(me,fe, ncol = 2)
ae <- ggplot(alive, aes(x = Treatment.ID, y = AT)) + geom_boxplot() + stat_compare_means(method = "wilcox.test", comparisons = list(c("gg","gs"), c("sg","ss"))) +
stat_summary(aes(x=factor(Treatment.ID)), position=position_dodge(.9), fun.data = fun_length,  geom = "text",
vjust = +1.5, size = 4) + labs(title = "Time to adult eclosion")
grid.arrange(ae, mfe)
grid.arrange(ae, mfe)
grid.arrange(tw, mfw)
grid.arrange(tw, mfw)
tw
grid.arrange(ae, mfe)
tw
grid.arrange(ae, mfe)
ae
grid.arrange(ae, mfe)
ae
grid.arrange(ae, mfe)
grid.arrange(tw, mfw)
getwd
getwd()
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
grid.arrange(tw, mfw)
library(ggpubr)
install.packages("ggpubr")
install.packages("gridExtra")
library(ggpubr)
library(gridExtra)
library(tidyr)
library(alr4)
f2.orig <- read.csv("Microbiome swap F2's - Sheet1.csv")
f2.fixed <- separate(data = f2.orig, col = Mother.Individual, into = c("mother", "individual"), sep = "\\.")
f2.fixed <- f2.fixed[-(35:40),]
ggplot(f2.fixed, aes(x = mother, y = Time.to.adulthood, fill = Treatment.ID)) + geom_boxplot()
ggplot(f2.fixed, aes(x = mother, y = Adult.size, fill = Treatment.ID)) + geom_boxplot()
mfull.time <- lm(Time.to.adulthood ~ Treatment.ID + Sex + BB.weight*Maternal.size, data = f2.fixed)
summary(mfull.time)
ggplot(f2.fixed, aes(x = mother, y = Time.to.adulthood, fill = Treatment.ID)) + geom_boxplot()
Anova(mfull.time)
lm(Time.to.adulthood ~ Treatment.ID, data = f2.fixed)
summary(lm(Time.to.adulthood ~ Treatment.ID, data = f2.fixed))
summary(lm(Time.to.adulthood ~ Treatment.ID + Sex, data = f2.fixed))
summary(lm(Time.to.adulthood ~ Treatment.ID + Maternal.size, data = f2.fixed))
summary(lm(Time.to.adulthood ~ Treatment.ID + Maternal.size*BB.weight, data = f2.fixed))
summary(lm(Time.to.adulthood ~ Treatment.ID + BB.weight, data = f2.fixed))
mfull.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight*Maternal.size, data = f2.fixed)
summary(mfull.size)
summary(lm(Adult.size ~ Treatment.ID, data = f2.fixed))
summary(lm(Adult.size ~ Treatment.ID + Sex, data = f2.fixed))
summary(lm(Adult.size ~ Sex, data = f2.fixed))
summary(lm(Adult.size ~ Sex + BB.weight, data = f2.fixed))
summary(lm(Adult.size ~ BB.weight, data = f2.fixed))
summary(lm(Adult.size ~ Maternal.size, data = f2.fixed))
View(f2.fixed)
summary(lm(Adult.size ~ Maternal.size*Mother, data = f2.fixed))
summary(lm(Adult.size ~ Maternal.size*mother, data = f2.fixed))
summary(lm(Adult.size ~ mother, data = f2.fixed))
summary(lm(Adult.size ~ Sex, data = f2.fixed))
summary(lm(Adult.size ~ Sex + Treatment.ID, data = f2.fixed))
summary(lm(Adult.size ~ Sex*Treatment.ID, data = f2.fixed))
Anova(mfull.size)
summary(mfull.size)
Anova(mfull.size)
summary(mfull.size)
summary(lm(Adult.size ~ Sex*Treatment.ID, data = f2.fixed))
summary(lm(Adult.size ~ Sex + Treatment.ID, data = f2.fixed))
Anova(mfull.size)
summary(mfull.size)
mred.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight:Maternal.size, data = f2.fixed)
summary(mred.size)
Anova(mred.size)
mred.size <- lm(Adult.size ~ Treatment.ID + Sex, data = f2.fixed)
summary(mred.size)
Anova(mred.size)
anova(mred.size, mfull.size)
Anova(mfull.time)
mmid.size <- lm(Adult.size ~ Treatment.ID + Sex + Maternal.size, data = f2.fixed)
summary(mmid.size)
summary(mred.size)
summary(mmid.size)
anova(mred.size,mmid.size)
mmid.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight, data = f2.fixed)
summary(mmid.size)
anova(mred.size,mmid.size)
mmid.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight:Maternalsize, data = f2.fixed)
summary(mmid.size)
mmid.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight:Maternal.size, data = f2.fixed)
summary(mmid.size)
anova(mred.size,mmid.size)
anova(mred.size, mfull.size)
Anova(mred.size)
Anova(mfull.size)
summary(mfull.size)
scatterplot(Adult.size ~ Maternal.size | Treatment.ID, data = f2.fixed)
Anova(mfull.time)
Anova(mfull.size)
scatterplot(Adult.size ~ BB.weight | Treatment.ID, data = f2.fixed)
scatterplot(Adult.size ~ Sex | Treatment.ID, data = f2.fixed)
summary(mfull.time)
Anova(mfull.time)
mfull.time <- lm(Time.to.adulthood ~ Treatment.ID + Sex + BB.weight*mother, data = f2.fixed)
summary(mfull.time)
Anova(mfull.time)
mfull.time <- lm(Time.to.adulthood ~ Treatment.ID + Sex + BB.weight*Maternal.size, data = f2.fixed)
summary(mfull.time)
Anova(mfull.time)
ggplot(f2.fixed, aes(x = mother, y = Time.to.adulthood, fill = Treatment.ID)) + geom_boxplot() + facet_wrap(~Sex)
ggplot(f2.fixed, aes(x = mother, y = Adult.size, fill = Treatment.ID)) + geom_boxplot() + facet_wrap(~Sex)
summary(mfull.time)
mfull.time <- lm(Time.to.adulthood ~ Treatment.ID + Sex + BB.weight*Maternal.size, data = f2.fixed)
summary(mfull.time)
Anova(mfull.time)
mred.time <- lm(Time.to.adulthood ~ Treatment.ID, data = f2.fixed)
summary(mred.time)
summary(mfull.time)
summary(f2.fixed)
str(f2.fixed)
f2.fixed$Maternal.size <- as.factor(f2.fixed$Maternal.size)
str(f2.fixed)
summary(mfull.time)
mfull.time <- lm(Time.to.adulthood ~ Treatment.ID + Sex + BB.weight*Maternal.size, data = f2.fixed)
summary(mfull.time)
Anova(mfull.time)
mred.time <- lm(Time.to.adulthood ~ Treatment.ID, data = f2.fixed)
summary(mred.time)
mred.time <- lm(Time.to.adulthood ~ Treatment.ID + Maternal.size, data = f2.fixed)
summary(mred.time)
View(f2.fixed)
str(f2.fixed)
Anova(mfull.time)
mfull.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight*Maternal.size, data = f2.fixed)
summary(mfull.size)
Anova(mfull.size)
summary(mfull.size)
Anova(mfull.size)
mred.size <- lm(Adult.size ~ Treatment.ID + Sex, data = f2.fixed)
summary(mred.size)
str(f2.fixed)
summary(mmid.size)
anova(mred.size,mmid.size)
f2.orig <- read.csv("Microbiome swap F2's - Sheet1.csv")
f2.fixed <- separate(data = f2.orig, col = Mother.Individual, into = c("mother", "individual"), sep = "\\.")
f2.fixed <- f2.fixed[-(35:40),]
mfull.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight*Maternal.size, data = f2.fixed)
mred.size <- lm(Adult.size ~ Treatment.ID + Sex, data = f2.fixed)
anova(mred.size,mmid.size)
anova(mred.size, mfull.size)
f2.fixed$Maternal.size <- as.factor(f2.fixed$Maternal.size)
mfull.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight*Maternal.size, data = f2.fixed)
mred.size <- lm(Adult.size ~ Treatment.ID + Sex, data = f2.fixed)
anova(mred.size, mfull.size)
summary(mfull.size)
summary(mred.size)
anova(mred.size, mfull.size)
mmid.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight:Maternal.size, data = f2.fixed)
summary(mmid.size)
anova(mred.size,mmid.size)
anova(mmid.size, mfull.size)
summary(mmid.size)
ggplot(f2.fixed, aes(x = Treatment.ID, y = Adult.size)) + geom_boxplot()
ggplot(f2.fixed, aes(x = Treatment.ID, y = Adult.size, fill = Sex)) + geom_boxplot()
summary(mmid.size)
anova(mred.size,mmid.size)
anova(mmid.size, mfull.size)
mtest.size <- lm(Adult.size ~ Treatment.ID*Sex + BB.weight:Maternal.size, data = f2.fixed)
summary(mtest.size)
summary(mmid.size)
summary(mtest.size)
Anova(mtest.size)
summary(mtest.size)
summary(mtest.size)
summary(mmid.size)
summary(mmid.size)
summary(mtest.size)
mfull.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight*Maternal.size, data = f2.fixed)
summary(mfull.size)
mred.size <- lm(Adult.size ~ Treatment.ID + Sex, data = f2.fixed)
summary(mred.size)
Anova(mred.size)
anova(mred.size, mfull.size)
mmid.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight:Maternal.size, data = f2.fixed)
summary(mmid.size)
anova(mred.size,mmid.size)
anova(mmid.size, mfull.size)
summary(mmid.size)
mtest.size <- lm(Adult.size ~ Treatment.ID*Sex + BB.weight:Maternal.size, data = f2.fixed)
summary(mtest.size)
Anova(mtest.size)
summary(mtest.size)
mtest.size <- lm(Adult.size ~ Treatment.ID*Sex, data = f2.fixed)
summary(mtest.size)
Anova(mtest.size)
mtest.size <- lm(Adult.size ~ Treatment.ID*Sex + BB.weight*Maternal.size, data = f2.fixed)
summary(mtest.size)
Anova(mtest.size)
mtest.size <- lm(Adult.size ~ Treatment.ID*Sex + BB.weight:Maternal.size, data = f2.fixed)
summary(mtest.size)
Anova(mtest.size)
library(GGally)
?ggpubr
??ggpubr
ggpairs(data = f2.fixed)
?ggpairs
ggpairs(data = f2.fixed, columns = 5)
ggpairs(data = f2.fixed, columns = c(5,8))
ggpairs(data = f2.fixed, columns = c(5,8,12))
ggpairs(data = f2.fixed, columns = c(5,8))
Anova(mtest.size)
summary(mtest.size)
summary(mtest.size)
mtest.size <- lm(Adult.size ~ Treatment.ID + BB.weight:Maternal.size, data = f2.fixed)
summary(mtest.size)
mtest.size <- lm(Adult.size ~ Sex + BB.weight:Maternal.size, data = f2.fixed)
summary(mtest.size)
mtest.size <- lm(Adult.size ~ Treatment.ID + BB.weight:Maternal.size, data = f2.fixed)
summary(mtest.size)
summary(mred.size)
summary(mtest.size)
summary(mfull.size)
mtest.size <- lm(Adult.size ~ Treatment.ID:Sex + BB.weight:Maternal.size, data = f2.fixed)
summary(mtest.size)
Anova(mtest.size)
mtest.size <- lm(Adult.size ~ Treatment.ID*Sex + BB.weight:Maternal.size, data = f2.fixed)
summary(mtest.size)
Anova(mtest.size)
mmid.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight:Maternal.size, data = f2.fixed)
summary(mmid.size)
scatterplot(Adult.size ~ BB.weight | Maternal.size, data = f2.fixed, smooth = FALSE)
scatterplot(Adult.size ~ BB.weight | Maternal.size, data = f2.fixed, smooth = FALSE)
summary(mtest.size)
summary(mred.size)
summary(mtest.size)
ggplot(f2.fixed, aes(x = mother, y = Time.to.adulthood, fill = Treatment.ID)) + geom_boxplot() + facet_wrap(~Sex)
ggplot(f2.fixed, aes(x = mother, y = Time.to.adulthood, fill = Treatment.ID)) + geom_boxplot() + facet_wrap(~Sex)
ggplot(f2.fixed, aes(x = mother, y = Time.to.adulthood, fill = Treatment.ID)) + geom_boxplot() + facet_wrap(~Sex)
summary(mtest.size)
summary(mmid.size)
summary(mtest.size)
summary(mmid.size)
anova(mred.size,mmid.size)
summary(mtest.size)
Anova(mtest.size)
summary(mmid.size)
Anova(mmid.size)
anova(mred.size,mmid.size)
anova(mred.size, mfull.size)
anova(mmid.size, mfull.size)
Anova(mtest.size)
summary(mtest.size)
summary(mred.time)
mred.time <- lm(Time.to.adulthood ~ Treatment.ID + Maternal.size, data = f2.fixed)
summary(mred.time)
mred.size <- lm(Adult.size ~ Treatment.ID + Sex, data = f2.fixed)
summary(mred.size)
anova(mred.size, mfull.size)
mmid.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight:Maternal.size, data = f2.fixed)
summary(mmid.size)
Anova(mmid.size)
summary(mmid.size)
ggplot(f2.fixed, aes(x = mother, y = Time.to.adulthood, fill = Treatment.ID)) + geom_boxplot()
ggplot(f2.fixed, aes(x = mother, y = Time.to.adulthood, fill = Treatment.ID)) + geom_boxplot() + facet_wrap(~Sex)
ggplot(f2.fixed, aes(x = mother, y = Adult.size, fill = Treatment.ID)) + geom_boxplot()
ggplot(f2.fixed, aes(x = Treatment.ID, y = Adult.size, fill = Sex)) + geom_boxplot()
library(ggpubr)
library(gridExtra)
library(tidyr)
library(alr4)
library(GGally)
f2.orig <- read.csv("Microbiome swap F2's - Sheet1.csv")
f2.fixed <- separate(data = f2.orig, col = Mother.Individual, into = c("mother", "individual"), sep = "\\.")
f2.fixed <- f2.fixed[-(35:40),]
f2.fixed$Maternal.size <- as.factor(f2.fixed$Maternal.size)
ggpairs(data = f2.fixed, columns = c(5,8))
ggplot(f2.fixed, aes(x = mother, y = Time.to.adulthood, fill = Treatment.ID)) + geom_boxplot()
ggplot(f2.fixed, aes(x = mother, y = Time.to.adulthood, fill = Treatment.ID)) + geom_boxplot() + facet_wrap(~Sex)
ggplot(f2.fixed, aes(x = mother, y = Adult.size, fill = Treatment.ID)) + geom_boxplot()
ggplot(f2.fixed, aes(x = Treatment.ID, y = Adult.size, fill = Sex)) + geom_boxplot()
ggplot(f2.fixed, aes(x = mother, y = Adult.size, fill = Treatment.ID)) + geom_boxplot() + facet_wrap(~Sex)
scatterplot(Adult.size ~  | Treatment.ID, data = f2.fixed)
ggplot(f2.fixed, aes(x = mother, y = Dead., fill = Treatment.ID)) + geom_point()
ggplot(f2.fixed, aes(x = Treatment.ID, y = Adult.size)) + geom_boxplot() + stat_compare_means(method = "wilcox.test", comparisons = list(c("gg","gs"))) +
stat_summary(aes(x=factor(Treatment.ID)), position=position_dodge(.9), fun.data = fun_length,  geom = "text",
vjust = +1.5, size = 4)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(ggpubr)
library(gridExtra)
swap.orig <- read.csv("Microbiome swap data - Sheet1.csv")
treatments <- swap.orig$Treatment.ID
dead <- swap.orig[swap.orig$Dead. == "y",]
alive <- swap.orig[swap.orig$Dead. == "",]
alive.female <- alive[alive$Sex == "f",]
alive.male <- alive[alive$Sex == "m",]
alive$Treatment.ID <- as.factor(alive$Treatment.ID)
alive$LT <- as.numeric(alive$LT)
View(swap.orig)
str(swap.orig)
m1 <- lm(Dead. ~ Treatment.ID, data = swap.orig)
summary(m1)
View(m1)
summary(m1)
summary(m1)$coef
View(swap.orig)
swap.model <- swap.orig
swap.model$dead <- ifelse(swap.model$Dead.=="y","","n")
View(swap.model)
swap.model$dead <- ifelse(swap.model$Dead.=="y","y","n")
m1 <- lm(dead ~ Treatment.ID, data = swap.orig)
str(swap.model$dead)
swap.model$dead <- as.factor(swap.model$dead)
m1 <- lm(dead ~ Treatment.ID, data = swap.orig)
str(swap.model$dead)
m1 <- lm(dead ~ Treatment.ID, data = swap.model)
summary(m1)$coef
str(swap.model$Treatment.ID)
swap.model$dead <- ifelse(swap.model$Dead.=="y","1","0")
str(swap.model$dead)
swap.model$dead <- as.factor(swap.model$dead)
m1 <- lm(dead ~ Treatment.ID, data = swap.model)
summary(m1)$coef
library(ggpubr)
library(gridExtra)
library(tidyr)
library(alr4)
library(GGally)
f2.orig <- read.csv("Microbiome swap F2's - Sheet1.csv")
f2.fixed <- separate(data = f2.orig, col = Mother.Individual, into = c("mother", "individual"), sep = "\\.")
f2.fixed <- f2.fixed[-(35:40),]
f2.fixed$Maternal.size <- as.factor(f2.fixed$Maternal.size)
mmid.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight:Maternal.size, data = f2.fixed)
f
#looking for which regressor can best explain the non-constant variance
Z1=with(f2.fixed,ncvTest(mmid.size, ~ Treatment.ID))
Z2=with(f2.fixed,ncvTest(mmid.size, ~ Sex))
Z3=with(f2.fixed,ncvTest(mmid.size, ~ Treatment.ID+Sex))
Z4=with(f2.fixed,ncvTest(mmid.size, ~ BB.weight:Maternal.size))
Z5=with(f2.fixed,ncvTest(mmid.size))
table1=rbind(with(Z1,c(Df,ChiSquare,p)),with(Z2,c(Df,ChiSquare,p)),with(Z3,c(Df,ChiSquare,p)),with(Z4,c(Df,ChiSquare,p)),with(Z5,c(Df,ChiSquare,p)))
row.names(table1)=c("Treatment","Sex","Treatment,Sex","Interaction","Fitted values")
colnames(table1)=c("df","Test statistic","p-Value")
table1
ncvTest(mmid.size)
mtest.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight:Maternal.size, data = f2.fixed, weights = Treatment.ID)
mtest.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight:Maternal.size, data = f2.fixed, weight = Treatment.ID)
mtest.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight:Maternal.size, data = f2.fixed, weights = Treatment.ID)
?anova
?Anova
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE)
rm(list=ls())
library(alr4)
robey <- Robey
m1 <- lm(tfr ~ region + contraceptors + region:contraceptors, data = robey)
m2 <- lm(tfr ~ contraceptors + region + region:contraceptors, data = robey)
#type I
anova(m2)
#type II
Anova(m2)
#Type I
anova(m1)
#Type II
Anova(m1)
m3 <- lm(tfr ~ region + contraceptors, data = robey)
m4 <- lm(tfr ~ contraceptors, data = robey)
anova(m3, m2)
anova(m4,m3)
auto <- stopping
scatterplot(Distance ~ Speed, data = auto, boxplots = FALSE)
mauto <- lm(Distance ~ Speed + I(Speed^2), data = auto)
Z1=with(auto,ncvTest(mauto))
Z2=with(auto,ncvTest(mauto, ~ Speed))
Z3=with(auto,ncvTest(mauto, ~ Speed + I(Speed^2)))
table1=rbind(with(Z1,c(Df,ChiSquare,p)),with(Z2,c(Df,ChiSquare,p)),with(Z3,c(Df,ChiSquare,p)))
row.names(table1)=c("Fitted Values (mean)","Speed","Speed and Speed^2")
colnames(table1)=c("df","Test statistic","p-Value")
table1
mauto2 <- lm(Distance ~ Speed + I(Speed^2), data = auto, weights = 1/Speed)
summary(mauto)
summary(mauto2)
library(lmtest)
>hccm
?hccm
coeftest(mmid.size, vcov=hccm)
mmid.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight:Maternal.size, data = f2.fixed)
f2.orig <- read.csv("Microbiome swap F2's - Sheet1.csv")
f2.fixed <- separate(data = f2.orig, col = Mother.Individual, into = c("mother", "individual"), sep = "\\.")
f2.fixed <- f2.fixed[-(35:40),]
f2.fixed$Maternal.size <- as.factor(f2.fixed$Maternal.size)
mmid.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight:Maternal.size, data = f2.fixed)
ncvTest(mmid.size)
coeftest(mmid.size, vcov=hccm)
summary(mmid.size)
Anova(mmid.size)
library(ggpubr)
library(gridExtra)
library(tidyr)
library(alr4)
library(GGally)
library(lmtest)
f2.orig <- read.csv("Microbiome swap F2's - Sheet1.csv")
f2.fixed <- separate(data = f2.orig, col = Mother.Individual, into = c("mother", "individual"), sep = "\\.")
f2.fixed <- f2.fixed[-(35:40),]
f2.fixed$Maternal.size <- as.factor(f2.fixed$Maternal.size)
mmid.size <- lm(Adult.size ~ Treatment.ID + Sex + BB.weight:Maternal.size, data = f2.fixed)
summary(mmid.size)
mred.size <- lm(Adult.size ~ Treatment.ID + Sex, data = f2.fixed)
summary(mred.size)
Anova(mmid.size)
summary(powerTransform(cbind(Adult.size, BB.weight, Maternal.size) ~ 1, f2.fixed))
mtest.size <- lm(Adult.size ~ BB.weight, data = f2.fixed)
summary(mtest.size)
mtest.size <- lm(Adult.size^2 ~ Treatment.ID + Sex + BB.weight:Maternal.size, data = f2.fixed)
summary(mtest.size)
summary(mmid.size)
mtest.size <- lm(Adult.size^2 ~ Treatment.ID + Sex + log(BB.weight):Maternal.size, data = f2.fixed)
summary(mtest.size)
summary(f2.fixed)
